(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0af118"],{"0d6d":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("nav",{staticClass:"vital-container cb"},[s("strong",{staticClass:"fl nav-title mt-10 f16"},[e._v("Users")]),e._v(" "),s("div",{staticClass:"fr"},[s("el-input",{staticClass:"radius-input search-input mr-15",attrs:{size:"medium",placeholder:"Please enter name"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.userSaerchBtn(t)}},model:{value:e.searchData.userName,callback:function(t){e.$set(e.searchData,"userName",t)},expression:"searchData.userName"}},[s("i",{staticClass:"el-input__icon el-icon-search cp",attrs:{slot:"suffix",title:"Search"},on:{click:e.userSaerchBtn},slot:"suffix"})]),e._v(" "),s("el-button",{staticClass:"filter-item shadow",attrs:{type:"primary",size:"medium",round:"",icon:"el-icon-plus"},on:{click:e.addUserBtn}},[e._v("Add")])],1)]),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"mt-20 table-content",staticStyle:{width:"100%"},attrs:{data:e.list,fit:"","highlight-current-row":""}},[s("no-data-table",{attrs:{slot:"empty"},slot:"empty"}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"No.",width:"80",type:"index"}}),e._v(" "),s("el-table-column",{attrs:{width:"150px",label:"Name"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.firstname+" "+t.row.lastname))])]}}])}),e._v(" "),s("el-table-column",{attrs:{width:"100px",align:"center",label:"Username"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.username))])]}}])}),e._v(" "),s("el-table-column",{attrs:{"min-width":"200px",align:"left",label:"Email"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e._f("emptyShow")(t.row.email)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{width:"100px",align:"center",label:"Roles"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(e.setRole(t.row)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"Operation",width:"250px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"el-icon-view color-main cp mr-10",attrs:{title:"Edit"},on:{click:function(s){return s.stopPropagation(),e.viewUserBtn(t.row)}}}),e._v(" "),-1===e.setRole(t.row).indexOf("admin")?s("i",{staticClass:"iconfont el-icon-edit color-main cp mr-10",attrs:{title:"Edit"},on:{click:function(s){return s.stopPropagation(),e.changeUserBtn(t.row)}}}):e._e(),e._v(" "),-1===e.setRole(t.row).indexOf("admin")?s("i",{staticClass:"iconfont icon-shanchu color-red cp",attrs:{title:"Delete"},on:{click:function(s){return s.stopPropagation(),e.delData(t.row)}}}):e._e()]}}])})],1),e._v(" "),s("div",{staticClass:"tr mt-25"},[s("el-pagination",{attrs:{background:"","page-size":10,"hide-on-single-page":"",layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),s("el-dialog",{attrs:{title:"View user",visible:e.viewUserDialog,width:"50%"},on:{"update:visible":function(t){e.viewUserDialog=t}}},[s("el-form",{ref:"addUser",staticClass:"mt-25",attrs:{"label-width":"110px"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"First name:",prop:"firstname"}},[e._v("\n            "+e._s(e._f("emptyShow")(e.viewUserData.firstname))+"\n          ")])],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"Last name:",prop:"lastname"}},[e._v("\n            "+e._s(e._f("emptyShow")(e.viewUserData.lastname))+"\n          ")])],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:22}},[s("el-form-item",{attrs:{label:"User name:",prop:"username"}},[e._v("\n            "+e._s(e._f("emptyShow")(e.viewUserData.username))+"\n          ")])],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:22}},[s("el-form-item",{attrs:{label:"Email:",prop:"email"}},[e._v("\n            "+e._s(e._f("emptyShow")(e.viewUserData.email))+"\n          ")])],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"Roles:",prop:"roles"}},[e._v("\n            "+e._s(e.viewUserData.roles?e.viewUserData.roles[0].name:"--")+"\n          ")])],1)],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.userCreatNew,width:"55%"},on:{"update:visible":function(t){e.userCreatNew=t}}},[s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.userEidtStatus?"Edit User":"Add User"))]),e._v(" "),s("el-form",{ref:"addUser",staticClass:"mt-25",attrs:{model:e.addUser,"label-width":"110px",rules:e.userRules}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"First name:",prop:"firstname"}},[s("el-input",{staticClass:"radius-input",attrs:{placeholder:"Please enter first name"},model:{value:e.addUser.firstname,callback:function(t){e.$set(e.addUser,"firstname",t)},expression:"addUser.firstname"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:10}},[s("el-form-item",{attrs:{label:"Last name:",prop:"lastname"}},[s("el-input",{staticClass:"radius-input",attrs:{placeholder:"Please enter last name"},model:{value:e.addUser.lastname,callback:function(t){e.$set(e.addUser,"lastname",t)},expression:"addUser.lastname"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:22}},[s("el-form-item",{attrs:{label:"User name:",prop:"username"}},[s("el-input",{staticClass:"radius-input",attrs:{placeholder:"Please enter user name"},model:{value:e.addUser.username,callback:function(t){e.$set(e.addUser,"username",t)},expression:"addUser.username"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:22}},[s("el-form-item",{attrs:{label:"Email:",prop:"email"}},[s("el-input",{staticClass:"radius-input",attrs:{placeholder:"Please enter email"},model:{value:e.addUser.email,callback:function(t){e.$set(e.addUser,"email",t)},expression:"addUser.email"}})],1)],1)],1),e._v(" "),e.userEidtStatus?e._e():s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:22}},[s("el-form-item",{attrs:{label:"Password:",prop:"password"}},[s("el-input",{staticClass:"radius-input",attrs:{type:"password",placeholder:"Please enter password"},model:{value:e.addUser.password,callback:function(t){e.$set(e.addUser,"password",t)},expression:"addUser.password"}})],1)],1)],1),e._v(" "),e.userEidtStatus?e._e():s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:22}},[s("el-form-item",{attrs:{label:"repeatPass:",prop:"checkPass"}},[s("el-input",{staticClass:"radius-input",attrs:{type:"password",placeholder:"Please repeat Password "},model:{value:e.addUser.checkPass,callback:function(t){e.$set(e.addUser,"checkPass",t)},expression:"addUser.checkPass"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"Roles:",prop:"roles"}},[s("el-checkbox-group",{model:{value:e.addUser.roles,callback:function(t){e.$set(e.addUser,"roles",t)},expression:"addUser.roles"}},e._l(e.rolesList,(function(e,t){return s("el-checkbox",{key:t,attrs:{label:e.name}})})),1)],1)],1)],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticClass:"btn-white shadow",attrs:{round:""},on:{click:function(t){e.userCreatNew=!1}}},[e._v("\n        Cancel")]),e._v(" "),s("el-button",{staticClass:"btn-orange shadow",attrs:{round:"",type:"primary"},on:{click:function(t){return e.saveUserBtn("addUser")}}},[e._v("Confirm")])],1)],1)],1)},r=[],n=s("b775");function i(e){return Object(n["a"])({url:"api/users",method:"get",params:e})}function l(e){return Object(n["a"])({url:"api/users/".concat(e.id),method:"PUT",data:e})}function o(e){return Object(n["a"])({url:"api/users/create",method:"POST",data:e})}function d(e){return Object(n["a"])({url:"api/roles",method:"GET",params:e})}function u(e){return Object(n["a"])({url:"api/users/".concat(e.id),method:"GET"})}var c={name:"InlineEditTable",filters:{statusFilter:function(e){return"停用"==e?"danger":"启用"==e?"success":void 0}},data:function(){var e=this,t=function(t,s,a){""===s?a(new Error("Please input a password")):(""!==e.addUser.checkPass&&e.$refs.addUser.validateField("checkPass"),a())},s=function(t,s,a){""===s?a(new Error("Please enter the password again.")):s!==e.addUser.password?a(new Error("The two passwords are inconsistent!")):a()};return{userCreatNew:!1,userEidtStatus:!1,databaseShow:!1,rolesList:[],addUser:{firstname:"",lastname:"",username:"",email:"",password:"",checkPass:"",roles:[]},rolesOptions:[],userRules:{username:[{required:!0,trigger:"blur"}],roles:[{required:!0}],password:[{required:!0},{validator:t,trigger:"blur"}],checkPass:[{required:!0},{required:!0,validator:s,trigger:"blur"}]},changeUser:{name:"",loginName:"",tel:"",department:"",email:"",roles:[],roleId:[],id:""},list:[],loading:!1,listLoading:!0,viewUserData:{},viewUserDialog:!1,page:0,total:0,searchData:{userLoginName:"",userName:"",userRoleName:"",userStatus:""}}},created:function(){this.getList(),this.getRoleType()},methods:{setRole:function(e){var t=e.roles.map((function(e){return e.name}));return t.join(",")},getRoleType:function(){var e=this,t={page:0,size:1e3};d(t).then((function(t){200===t.code&&(e.rolesList=t.data.content,e.rolesList=e.rolesList.filter((function(e){return"admin"!==e.name})))}))},changeUserBtn:function(e){this.userEidtStatus=!0,this.userCreatNew=!0,this.addUser.username=e.username,this.addUser.firstname=e.firstname,this.addUser.lastname=e.lastname,this.addUser.email=e.email,this.addUser.id=e.id,this.addUser.roles=e.roles.map((function(e){return e.name}))},delData:function(e){var t=this;this.$confirm("Are you sure you want to delete data?",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then((function(){u(e).then((function(e){200===e.code&&(t.$message({type:"success",message:"Delete success."}),t.getList())}))})).catch((function(){}))},userSaerchBtn:function(){this.searchData.userName=this.searchData.userName?this.searchData.userName.trim():null,this.searchData.userLoginName=this.searchData.userLoginName?this.searchData.userLoginName.trim():null,this.userPage=1,this.getList()},saveUserBtn:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;if(t.userEidtStatus){var s=[];t.addUser.roles.map((function(e){t.rolesList.map((function(t){e===t.name&&s.push(t)}))}));var a={email:t.addUser.email,firstname:t.addUser.firstname,lastname:t.addUser.lastname,password:t.addUser.password,username:t.addUser.username,id:t.addUser.id,roles:s};l(a).then((function(e){200===e.code&&(t.$message({type:"success",message:"Update user success."}),t.userCreatNew=!1,t.resetForm("addUser"),t.getList())}))}else{var r=[];t.addUser.roles.map((function(e){t.rolesList.map((function(t){e===t.name&&r.push(t)}))}));var n={email:t.addUser.email,firstname:t.addUser.firstname,lastname:t.addUser.lastname,password:t.addUser.password,username:t.addUser.username,roles:r};o(n).then((function(e){200===e.code&&(t.$message({type:"success",message:"Add user success."}),t.userCreatNew=!1,t.resetForm("addUser"),t.getList())}))}}))},addUserBtn:function(){this.userCreatNew=!0,this.userEidtStatus=!1,this.resetForm("addUser")},viewUserBtn:function(e){this.viewUserDialog=!0,this.viewUserData=e},changeUserRole:function(e){var t=this;this.changeUser.roleId=[],e.forEach((function(e){t.rolesOptions.forEach((function(s){e===s.roleName&&t.changeUser.roleId.push(s.id)}))}))},handleCurrentChange:function(e){this.page=e-1,this.getList()},handleFilter:function(){this.page=1,this.getList()},getList:function(){var e=this;this.listLoading=!1,this.listLoading=!0;var t={page:this.page,size:10,name:this.searchData.userName};i(t).then((function(t){200===t.code&&(e.list=t.data.content,e.listLoading=!1,e.total=t.data.totalElements)}))},resetForm:function(e){this.$refs[e].resetFields()}}},m=c,p=s("4023"),f=Object(p["a"])(m,a,r,!1,null,"6c14aef6",null);t["default"]=f.exports}}]);