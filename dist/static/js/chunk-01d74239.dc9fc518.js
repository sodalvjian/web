(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01d74239"],{"0167":function(t,a,e){},"1f6d":function(t,a,e){"use strict";var s=e("8a34"),n=e.n(s);n.a},"4bb3":function(t,a,e){"use strict";var s=e("672e"),n=e.n(s);n.a},"672e":function(t,a,e){},"8a34":function(t,a,e){},"9c82":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"app-container calendar-list-container"},[e("el-tabs",{model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[e("el-tab-pane",{attrs:{lazy:"",label:"Task",name:"first"}},[e("registered-tasks"),t._v(" "),e("active-tasks")],1),t._v(" "),e("el-tab-pane",{attrs:{lazy:"",label:"Data sources",name:"second"}},[e("input-module")],1),t._v(" "),e("el-tab-pane",{attrs:{lazy:"",label:"Pipelines",name:"fourth"}},[e("pipelines-module")],1),e("el-tab-pane",{attrs:{lazy:"",label:"Workers",name:"third"}},[e("work-module")],1)],1)],1)},n=[],i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("nav",{staticClass:"vital-container cb"},[e("strong",{staticClass:"fl nav-title mt-10 f16"},[t._v("Active Tasks")]),t._v(" "),e("div",{staticClass:"fr"},[e("el-select",{staticClass:"radius-input mr-15",attrs:{size:"medium",clearable:"",placeholder:"Please select type"},on:{change:t.dataSaerchBtn},model:{value:t.searchData.status,callback:function(a){t.$set(t.searchData,"status",a)},expression:"searchData.status"}},t._l(t.statusOptions,(function(t,a){return e("el-option",{key:a,attrs:{label:t,value:t}})})),1),t._v(" "),e("el-input",{staticClass:"radius-input search-input mr-15",attrs:{size:"medium",clearable:"",placeholder:"Please enter the keyword"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.dataSaerchBtn(a)}},model:{value:t.searchData.name,callback:function(a){t.$set(t.searchData,"name","string"===typeof a?a.trim():a)},expression:"searchData.name"}},[e("i",{staticClass:"el-input__icon el-icon-search cp",attrs:{slot:"suffix",title:"Search"},on:{click:t.dataSaerchBtn},slot:"suffix"})])],1)]),t._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticClass:"mt-20 table-content",staticStyle:{width:"100%"},attrs:{data:t.list,fit:"","highlight-current-row":""}},[e("no-data-table",{attrs:{slot:"empty"},slot:"empty"}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"Task Id",width:"130",prop:"id"}}),t._v(" "),e("el-table-column",{attrs:{width:"160px",label:"Name"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.name))])]}}])}),t._v(" "),e("el-table-column",{attrs:{width:"120px",align:"left",label:"Status"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.status))])]}}])}),t._v(" "),e("el-table-column",{attrs:{width:"120px",prop:"docCount",align:"center",label:"Total#"}}),t._v(" "),e("el-table-column",{attrs:{width:"120",prop:"processedCount",align:"center",label:"Processed#"}}),t._v(" "),e("el-table-column",{attrs:{width:"90",prop:"sharding",align:"center",label:"Sharding"}}),t._v(" "),e("el-table-column",{attrs:{"min-width":"160px",label:"Date"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n        "+t._s(t._f("setHourDate")(a.row.date))+"\n      ")]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"Operation",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{title:"View",type:"text"},on:{click:function(e){return t.changeDataBtn(a.row)}}},[e("i",{staticClass:"iconfont el-icon-view"})])]}}])})],1),t._v(" "),e("div",{staticClass:"tr mt-25"},[e("el-pagination",{attrs:{background:"","hide-on-single-page":"","page-size":10,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),e("el-dialog",{attrs:{visible:t.dataCreatNew,title:"View Task",width:"70%"},on:{"update:visible":function(a){t.dataCreatNew=a}}},[e("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.addDataLoading,expression:"addDataLoading"}],ref:"addData",attrs:{model:t.addData,"label-width":"120px",rules:t.dataRules}},[0===t.creatNewActive?e("div",{staticClass:"mt-10 mb-20"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Name:",prop:"name"}},[t._v("\n              "+t._s(t.addData.name)+"\n            ")])],1)],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Description:",prop:"dataName"}},[t._v("\n              "+t._s(t.addData.description)+"\n            ")])],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{label:"Pipeline:"}},[t._v("\n              "+t._s(t.addData.pipeline)+"\n            ")])],1),t._v(" "),e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{label:"DataSource:"}},[t._v("\n              "+t._s(t.addData.datasources)+"\n            ")])],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{label:"DataTarget:"}},[t._v("\n              "+t._s(t._f("emptyShow")(t.addData.datatargets))+"\n            ")])],1),t._v(" "),e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{label:"Sharding:"}},[t._v("\n              "+t._s(t.addData.sharding)+"\n            ")])],1)],1),t._v(" "),"ERROR"===t.addData.status?e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:22}},[e("el-form-item",{staticClass:"color-red",attrs:{label:"Types of Errors:"}},[e("span",{staticClass:"f14 color-red",domProps:{innerHTML:t._s(t.addData.trace?t.addData.trace.replace(/\r\n/g,"<br>"):"--")}})])],1)],1):t._e()],1):t._e(),t._v(" "),1===t.creatNewActive?e("div",{staticClass:"mt-40"},[t.saveResultData.schedule.length>0?e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Schedule:"}},t._l(t.saveResultData.schedule,(function(a,s){return e("el-row",{key:s,attrs:{gutter:20}},[e("el-col",{attrs:{span:20}},[e("span",{staticClass:"color-black",domProps:{innerHTML:t._s(t.setScheduleShow(a))}})])],1)})),1)],1)],1):t._e()],1):t._e()])],1)],1)},l=[],r=(e("81ea"),e("de52")),o=e.n(r),d=e("b775");function c(t){return Object(d["a"])({url:"api/works/getItemsByWhere",method:"GET",params:t})}function u(t){return Object(d["a"])({url:"api/works/".concat(t),method:"GET"})}var p={name:"InlineEditTable",components:{},filters:{statusFilter:function(t){return"停用"==t?"danger":"启用"==t?"success":void 0},setStatus:function(t){switch(t){case 0:return"PENDING";case 1:return"ASSIGN";case 2:return"ACTIVE";case 3:return"COMPLETE";case 4:return"ERROR"}},setDate:function(t){return t?o()(t).utcOffset(2*-(new Date).getTimezoneOffset()).format("YYYY-MM-DD HH:mm:ss"):"--"},setType:function(t){return 2===t?"Database":"Elsticsearch"}},data:function(){return{scheduleType:"Run Once",scheduleData:{weekDays:[]},saveResultData:{schedule:[]},creatNewActive:0,scheduleAllData:[],dataCreatNew:!1,addDataLoading:!1,dataEidtStatus:!1,databaseShow:!1,statusOptions:["PENDING","ASSIGN","ACTIVE","COMPLETE","ERROR"],typeOptions:[{label:"Elesticsearch",value:"ElESTICSEARCH"},{label:"Database",value:"DATABASE"}],addData:{type:"ElESTICSEARCH",id:0,url:"",name:"",description:"",username:"",password:"",driver:""},cmOptions:{tabSize:4,mode:"text/javascript",theme:"base16-dark",lineNumbers:!0,line:!0},rolesOptions:[],dataRules:{dataLoginName:[{required:!0,message:"Please enter name",trigger:"blur"}]},changeData:{name:"",loginName:"",tel:"",department:"",email:"",roles:[],roleId:[],id:""},list:[],loading:!1,listLoading:!1,viewDataData:{},page:0,total:0,searchData:{dataLoginName:"",name:null,dataRoleName:"",dataStatus:"",status:[]},sourceTestData:[],sourceTableOptions:[],sourceTextOptions:[],sourceModifiedOptions:[],pipelinesOptions:[],datasourcesOptions:[],datatargetsOptions:[]}},created:function(){this.getList()},methods:{setScheduleShow:function(t){switch(t.recurrence){case 0:return'Run once on <span class="f16 color-green fb"> '.concat(o()(t.startDate).format("YYYY-MM-DD"),' </span>, at  <span class="f16 color-green fb"> ').concat(t.time," </span>");case 1:return'Starting from <span class="f16 color-green fb"> '.concat(o()(t.startDate).format("YYYY-MM-DD"),' </span>, every day at <span class="f16 color-green fb"> ').concat(t.time,' </span>, until <span class="f16 color-green fb"> ').concat(o()(t.endDate).format("YYYY-MM-DD")," </span>");case 2:return'Starting from <span class="f16 color-green fb"> '.concat(o()(t.startDate).format("YYYY-MM-DD")," </span>, ").concat(setWeek(t.weekDays),' days of every week  at <span class="f16 color-green fb"> ').concat(t.time,' </span>, until <span class="f16 color-green fb"> ').concat(o()(t.endDate).format("YYYY-MM-DD")," </span>");case 3:return'Starting from <span class="f16 color-green fb"> '.concat(o()(t.startDate).format("YYYY-MM-DD"),' </span>, day <span class="f16 color-green fb">').concat(t.day,'</span> of every month at <span class="f16 color-green fb"> ').concat(t.time,' </span>, until <span class="f16 color-green fb"> ').concat(o()(t.endDate).format("YYYY-MM-DD")," </span>");case 4:return'Starting from <span class="f16 color-green fb"> '.concat(o()(t.startDate).format("YYYY-MM-DD"),' </span>, monitor the datasource, until <span class="f16 color-green fb"> ').concat(o()(t.endDate).format("YYYY-MM-DD")," </span>\n")}},delSchedule:function(t){var a=this;this.saveResultData.schedule.map((function(e,s){e.name===t.name&&a.saveResultData.schedule.splice(s,1)}))},setWeek:function(t){switch(t){case 0:return"Sun";case 1:return"Mon";case 2:return"Tue";case 3:return"Wed";case 4:return"Thu";case 5:return"Fri";case 6:return"Sat"}},getPipelines:function(){var t=this,a={page:0,q:"",size:1e3};this.pubFun.httpRequest("get","api/pipelines/select",null,(function(a){t.pipelinesOptions=a}),a)},getDatasources:function(){var t=this,a={page:0,q:"",size:1e3};this.pubFun.httpRequest("get","api/datasources/select",null,(function(a){t.datasourcesOptions=a}),a)},getDatatargets:function(){var t=this,a={page:0,q:"",size:1e3};this.pubFun.httpRequest("get","api/datatargets/select",null,(function(a){t.datatargetsOptions=a}),a)},changeSourceData:function(){var t=this,a=[],e=[];this.sourceTestData.map((function(s){if(s.name===t.addData.tblName){var n=Object.values(s.columns);n.map((function(t){"VARCHAR"===t.typeName?a.push(t.name):"DATETIME"===t.typeName&&e.push(t.name)}))}})),this.sourceTextOptions=a,this.sourceModifiedOptions=e},getSourceData:function(){var t=this;if(0==this.sourceTableOptions.length){var a={uri:this.addData.url,username:this.addData.username?this.addData.username:"null",password:this.addData.password?this.addData.password:"null",driver:this.addData.driver?this.addData.driver:"null"};this.pubFun.httpRequest("post","api/test-sch",null,(function(a){var e=Object.values(a.tables);t.sourceTestData=e;var s=[];e.map((function(t){"TABLE"===t.type&&s.push(t.name)})),t.sourceTableOptions=s}),a)}},testUrl:function(){var t=this,a={srcType:this.addData.srcType,uri:this.addData.url,username:this.addData.username?this.addData.username:"null",password:this.addData.password?this.addData.password:"null",driver:this.addData.driver?this.addData.driver:"null"};this.pubFun.httpRequest("post","api/test-uri",null,(function(a){t.$message.success("Test succeeded.")}),a)},selectType:function(){"ElESTICSEARCH"==this.addData.srcType?this.databaseShow=!1:this.databaseShow=!0},changeDataBtn:function(t){var a=this;this.dataEidtStatus=!0,this.dataCreatNew=!0,this.addDataLoading=!0,u(t.id).then((function(t){200===t.code&&(a.addData=t.data,a.addData.pipeline=t.data.pipeline.name,a.addData.datasources=t.data.datasource.name,a.addData.datatargets=t.data.datatarget?t.data.datatarget.name:"",a.addDataLoading=!1,a.creatNewActive=0)}))},delData:function(t){var a=this;this.$confirm("Are you sure you want to delete data?",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then((function(){a.pubFun.httpRequest("delete","api/works/".concat(t.id),null,(function(t){a.$message({type:"success",message:"Delete Success!"}),a.getList()}))})).catch((function(){}))},dataSaerchBtn:function(){this.searchData.name=this.searchData.name?this.searchData.name.trim():null,this.dataPage=1,this.getList()},saveDataBtn:function(){var t=this;this.addDataLoading=!0,this.pubFun.httpRequest("put","api/works/".concat(this.saveResultData.id),this.saveResultData,(function(a){t.$message({type:"success",message:"Success!"}),t.dataCreatNew=!1,t.addDataLoading=!1,t.getList()}))},nextDataBtn:function(t){this.creatNewActive=1},getDatasourceObj:function(){var t=this,a={};return this.datasourcesOptions.map((function(e){e.name===t.addData.datasources&&(a=e)})),a},getDatatargetsObj:function(){var t=this,a={};return this.datatargetsOptions.map((function(e){e.name===t.addData.datatargets&&(a=e)})),a},getPipelineObj:function(){var t=this,a={};return this.pipelinesOptions.map((function(e){e.name===t.addData.pipeline&&(a=e)})),a},addDataBtn:function(){this.dataCreatNew=!0,this.dataEidtStatus=!1,this.scheduleAllData=[],this.getPipelines(),this.getDatasources(),this.getDatatargets(),this.addData={name:"",description:"",id:0,datasource:"",datatarget:"",pipeline:"",sharding:""},this.saveResultData.schedule=[],this.scheduleType="Run Once",this.scheduleData.startDate="",this.scheduleData.time="",this.scheduleData.day="",this.scheduleData.endDate="",this.scheduleData.weekDays=[]},changeDataRole:function(t){var a=this;this.changeData.roleId=[],t.forEach((function(t){a.rolesOptions.forEach((function(e){t==e.roleName&&a.changeData.roleId.push(e.id)}))}))},handleCurrentChange:function(t){this.page=t-1,this.getList()},handleFilter:function(){this.getList()},getList:function(){var t=this;this.listLoading=!0;var a={page:this.page,size:10,name:this.searchData.name,status:this.searchData.status};c(a).then((function(a){200===a.code&&(t.list=a.data.content,t.listLoading=!1,t.total=a.data.totalElements)}))},cancelEdit:function(t){t.title=t.originalTitle,t.edit=!1,this.$message({message:"The title has been restored to the original value",type:"warning"})},confirmEdit:function(t){t.edit=!1,t.originalTitle=t.title,this.$message({message:"The title has been edited",type:"success"})},getRolesList:function(){var t=this;this.pubFun.httpRequest("get","role/listAllRoles",null,(function(a,e,s){0==a&&(t.rolesOptions=e)}))},resetForm:function(t){this.$refs[t].resetFields(),this.changeData.roleId&&(this.changeData.roleId=[])}}},h=p,m=(e("4bb3"),e("4023")),D=Object(m["a"])(h,i,l,!1,null,null,null),f=D.exports,g=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("nav",{staticClass:"vital-container cb"},[e("strong",{staticClass:"fl nav-title mt-10 f16"},[t._v("Task Configuations")]),t._v(" "),e("div",{staticClass:"fr"},[e("el-input",{staticClass:"radius-input search-input mr-15",attrs:{size:"medium",clearable:"",placeholder:"Please enter the keyword"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.dataSaerchBtn(a)}},model:{value:t.searchData.name,callback:function(a){t.$set(t.searchData,"name",a)},expression:"searchData.name"}},[e("i",{staticClass:"el-input__icon el-icon-search cp",attrs:{slot:"suffix",title:"Search"},on:{click:t.dataSaerchBtn},slot:"suffix"})]),t._v(" "),e("el-button",{staticClass:"filter-item shadow",attrs:{type:"primary",size:"medium",icon:"el-icon-plus"},on:{click:t.addDataBtn}},[t._v("Add")])],1)]),t._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticClass:"mt-20 table-content",staticStyle:{width:"100%"},attrs:{data:t.list,fit:"","highlight-current-row":""}},[e("no-data-table",{attrs:{slot:"empty"},slot:"empty"}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"Task Id",width:"130",prop:"id"}}),t._v(" "),e("el-table-column",{attrs:{width:"160px",label:"Name"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.name))])]}}])}),t._v(" "),e("el-table-column",{attrs:{"min-width":"200px",align:"left",label:"Next Run"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("setHourDate")(a.row.nextRun)))])]}}])}),t._v(" "),e("el-table-column",{attrs:{width:"200px",align:"left",label:"Last Run"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t._f("setHourDate")(a.row.lastRun)))])]}}])}),t._v(" "),e("el-table-column",{attrs:{"min-width":"200px",label:"Date"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n        "+t._s(t._f("setHourDate")(a.row.date))+"\n      ")]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"Operation",width:"250px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{title:"Edit",type:"text"},on:{click:function(e){return t.changeDataBtn(a.row)}}},[e("i",{staticClass:"iconfont el-icon-edit"})]),t._v(" "),e("el-button",{attrs:{type:"text",title:"Delete"},on:{click:function(e){return t.delData(a.row)}}},[e("i",{staticClass:"iconfont icon-shanchu color-red"})])]}}])})],1),t._v(" "),e("div",{staticClass:"tr mt-25"},[e("el-pagination",{attrs:{"hide-on-single-page":"",background:"","page-size":10,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),e("el-dialog",{attrs:{visible:t.dataCreatNew,title:t.dataEidtStatus?"Edit Task":"Add Task",width:"70%"},on:{"update:visible":function(a){t.dataCreatNew=a}}},[e("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.addDataLoading,expression:"addDataLoading"}],ref:"addData",attrs:{model:t.addData,"label-width":"120px",rules:t.dataRules}},[e("el-steps",{attrs:{"align-center":!0,active:t.creatNewActive,"finish-status":"success"}},[e("el-step",{attrs:{title:"Task Profile"}}),t._v(" "),e("el-step",{attrs:{title:"Task Schedule"}})],1),t._v(" "),0===t.creatNewActive?e("div",{staticClass:"mt-40"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Name:",prop:"name"}},[e("el-input",{attrs:{placeholder:"Please enter name"},model:{value:t.addData.name,callback:function(a){t.$set(t.addData,"name",a)},expression:"addData.name"}})],1)],1)],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Description:",prop:"description"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:3},placeholder:"Please enter date"},model:{value:t.addData.description,callback:function(a){t.$set(t.addData,"description",a)},expression:"addData.description"}})],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{label:"Pipeline:",prop:"pipeline"}},[e("el-select",{staticClass:"w",attrs:{"no-data-text":"no data",placeholder:"Please select"},model:{value:t.addData.pipeline,callback:function(a){t.$set(t.addData,"pipeline",a)},expression:"addData.pipeline"}},t._l(t.pipelinesOptions,(function(t,a){return e("el-option",{key:a,attrs:{label:t.name,value:t.name}})})),1)],1)],1),t._v(" "),e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{label:"DataSource:",prop:"datasources"}},[e("el-select",{staticClass:"w",attrs:{"no-data-text":"no data",placeholder:"Please select"},on:{change:t.select_status},model:{value:t.addData.datasources,callback:function(a){t.$set(t.addData,"datasources",a)},expression:"addData.datasources"}},t._l(t.datasourcesOptions,(function(t,a){return e("el-option",{key:a,attrs:{label:t.name,value:t.name}})})),1)],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:11}},[e("el-form-item",{attrs:{label:"Sharding:",prop:"sharding"}},[e("el-select",{attrs:{placeholder:"Please select"},model:{value:t.addData.sharding,callback:function(a){t.$set(t.addData,"sharding",a)},expression:"addData.sharding"}},t._l(t.shardingOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}})],1):t._e(),t._v(" "),1===t.creatNewActive?e("div",{staticClass:"mt-40"},[t.saveResultData.schedule.length>0?e("el-row",{attrs:{gutter:20}},[e("el-col",{staticClass:"beauty-list-tasks",attrs:{span:22}},[e("el-form-item",{attrs:{label:"Schedule:"}},t._l(t.saveResultData.schedule,(function(a,s){return e("el-row",{key:s,attrs:{gutter:20}},[e("el-col",{attrs:{span:20}},[e("span",{staticClass:"color-black",domProps:{innerHTML:t._s(t.setScheduleShow(a))}})]),t._v(" "),e("el-col",{attrs:{span:2}},[e("i",{staticClass:"iconfont icon-shanchu color-red cp",on:{click:function(a){return t.delSchedule(s)}}})])],1)})),1)],1)],1):t._e(),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"New Schedule:"}},[e("el-radio-group",{on:{change:t.setSchedule},model:{value:t.scheduleType,callback:function(a){t.scheduleType=a},expression:"scheduleType"}},[e("el-radio-button",{attrs:{label:"Run Once"}}),t._v(" "),e("el-radio-button",{attrs:{label:"Daily"}}),t._v(" "),e("el-radio-button",{attrs:{label:"Weekly"}}),t._v(" "),e("el-radio-button",{attrs:{label:"Monthly"}})],1)],1)],1),t._v(" "),e("el-col",{attrs:{span:22}},[e("el-row",{attrs:{gutter:20}},[e("el-form-item",{attrs:{label:""}},[e("el-col",{attrs:{span:8}},[e("div",{staticClass:"f12 color-8"},[t._v("Start date")]),t._v(" "),e("el-date-picker",{staticClass:"w",attrs:{"popper-class":"process-data-picker",format:"",placeholder:"Start Date",type:"Monitor"!==t.scheduleType?"datetime":"date","picker-options":t.pickerOptionsStart},on:{change:t.valideStartDate},model:{value:t.scheduleData.startDate,callback:function(a){t.$set(t.scheduleData,"startDate",a)},expression:"scheduleData.startDate"}})],1),t._v(" "),"Monthly"===t.scheduleType?e("el-col",{attrs:{span:4}},[e("div",{staticClass:"f12 color-8"},[t._v("Day")]),t._v(" "),e("el-input",{staticClass:"w",attrs:{type:"number",placeholder:"Day"},model:{value:t.scheduleData.day,callback:function(a){t.$set(t.scheduleData,"day",a)},expression:"scheduleData.day"}})],1):t._e(),t._v(" "),"Run Once"!==t.scheduleType?e("el-col",{attrs:{span:8}},[e("div",{staticClass:"f12 color-8"},[t._v("End date")]),t._v(" "),e("el-date-picker",{staticClass:"w",attrs:{"picker-options":t.pickerOptionsEnd,type:"date",placeholder:"End Date"},model:{value:t.scheduleData.endDate,callback:function(a){t.$set(t.scheduleData,"endDate",a)},expression:"scheduleData.endDate"}})],1):t._e()],1)],1)],1)],1),t._v(" "),"Weekly"===t.scheduleType?e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:22}},[e("el-form-item",[e("el-checkbox-group",{model:{value:t.scheduleData.weekDays,callback:function(a){t.$set(t.scheduleData,"weekDays",a)},expression:"scheduleData.weekDays"}},[e("el-checkbox-button",{attrs:{label:"Sun",value:"0"}},[t._v("Sun")]),t._v(" "),e("el-checkbox-button",{attrs:{label:"Mon",value:"1"}}),t._v(" "),e("el-checkbox-button",{attrs:{label:"Tue",value:"2"}}),t._v(" "),e("el-checkbox-button",{attrs:{label:"Wed",value:"3"}}),t._v(" "),e("el-checkbox-button",{attrs:{label:"Thu",value:"4"}}),t._v(" "),e("el-checkbox-button",{attrs:{label:"Fri",value:"5"}}),t._v(" "),e("el-checkbox-button",{attrs:{label:"Sat",value:"6"}})],1)],1)],1)],1):t._e(),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:""}},[e("el-button",{attrs:{disabled:t.buttonDisabled,type:"success",icon:"el-icon-circle-plus"},on:{click:t.addScheduleData}},[t._v("ADD")])],1)],1)],1)],1):t._e(),t._v(" "),e("span",{staticClass:"dialog-footer tr w disinblock mt-25 mb-10"},[e("el-button",{staticClass:"btn-white shadow",on:{click:function(a){t.dataCreatNew=!1}}},[t._v("\n          Cancel")]),t._v(" "),0===t.creatNewActive?e("el-button",{staticClass:"btn-orange shadow",attrs:{type:"primary"},on:{click:function(a){return t.nextDataBtn("addData")}}},[e("i",{staticClass:"el-icon-caret-right f14 mr-5"}),t._v("Next")]):t._e(),t._v(" "),1===t.creatNewActive?e("el-button",{staticClass:"btn-orange shadow",attrs:{disabled:t.buttonDisabled,type:"primary"},on:{click:function(a){return t.saveDataBtn("addData")}}},[e("i",{staticClass:"iconfont icon-save f14 mr-5"}),t._v("Save")]):t._e()],1)],1)],1),t._v(" "),e("el-dialog",{attrs:{title:"CHange pipeline file",visible:t.dialogVisible,"close-on-click-modal":t.modelCLose,width:"40%"},on:{"update:visible":function(a){t.dialogVisible=a}}},[e("el-row",[e("el-col",{attrs:{span:24}},[e("el-upload",{ref:"upload",staticClass:"upload-content",attrs:{headers:t.uploadHeader,accept:".jar","on-success":t.uploadSuccess,"on-error":t.uploadError,data:t.uploadData,drag:"",action:t.baseUrl+"/api/upload",limit:1,"on-change":t.handleChange,"before-remove":t.beforeRemove,"on-remove":t.removeFile,"auto-upload":!1,"file-list":t.fileList}},[e("svg",{staticClass:"icon f65 mt-40 mb-10",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-A"}})]),t._v(" "),e("div",{staticClass:"el-upload__text"},[t._v("\n            Drag the file here,or "),e("em",[t._v("click upload")])])])],1)],1),t._v(" "),e("span",{staticClass:"dialog-footer tr w disinblock mt-25 mb-10"},[e("el-button",{staticClass:"btn-white shadow",on:{click:function(a){t.dialogVisible=!1}}},[t._v("\n        Cancel")]),t._v(" "),e("el-button",{staticClass:"btn-orange shadow",attrs:{loading:t.uploadLoading,type:"primary"},on:{click:t.uploadFile}},[t._v("Confirm")])],1)],1)],1)},b=[],v=e("4360");function w(t){return Object(d["a"])({url:"api/tasks/byName",method:"GET",params:t})}function C(t){return Object(d["a"])({url:"role/listAllRoles",method:"GET",params:t})}function y(t){return Object(d["a"])({url:"api/pipelines/select",method:"GET",params:t})}function _(t){return Object(d["a"])({url:"api/datatargets/select",method:"GET",params:t})}function k(t){return Object(d["a"])({url:"api/datasources/select",method:"GET",params:t})}function S(t){return Object(d["a"])({url:"api/test-sch",method:"POST",data:t})}function T(t){return Object(d["a"])({url:"api/tasks/".concat(t),method:"get"})}function E(t){return Object(d["a"])({url:"api/tasks/".concat(t),method:"delete"})}function O(t,a){return Object(d["a"])({url:"api/tasks/".concat(t),method:"put",data:a})}function x(t){return Object(d["a"])({url:"api/tasks",method:"post",data:t})}var L={name:"InlineEditTable",data:function(){var t=this;return{scheduleType:"Run Once",uploadLoading:!1,baseUrl:"/clampee",uploadHeader:{Authorization:"Bearer "+v["a"].getters.token},modelCLose:!0,uploadData:{uid:""},fileList:[],scheduleData:{startDate:"",time:"",day:"",endDate:"",weekDays:[]},buttonDisabled:!1,dialogVisible:!1,saveResultData:{schedule:[]},creatNewActive:0,scheduleAllData:[],dataCreatNew:!1,addDataLoading:!1,dataEidtStatus:!1,databaseShow:!1,shardingOptions:[1,2,4,8,16,32],typeOptions:[{label:"Elesticsearch",value:"ElESTICSEARCH"},{label:"Database",value:"DATABASE"}],addData:{type:"ElESTICSEARCH",id:0,url:"",name:"",description:"",username:"",password:"",driver:"",datasources:"",pipeline:"",datatargets:"",datatargetEs:""},cmOptions:{tabSize:4,mode:"text/javascript",theme:"base16-dark",lineNumbers:!0,line:!0},rolesOptions:[],dataRules:{name:[{required:!0,message:"Please enter name",trigger:"blur"}],pipeline:[{required:!0,message:"Please select"}],datasources:[{required:!0,message:"Please select"}],sharding:[{required:!0,message:"Please enter sharding",trigger:"blur"}]},changeData:{name:"",loginName:"",tel:"",department:"",email:"",roles:[],roleId:[],id:""},list:[],loading:!1,listLoading:!1,viewDataData:{},page:0,total:0,searchData:{dataLoginName:"",name:null,dataRoleName:"",dataStatus:""},sourceTestData:[],sourceTableOptions:[],sourceTextOptions:[],sourceModifiedOptions:[],pipelinesOptions:[],datasourcesOptions:[],datatargetsOptions:[],datatargetsOptionsDb:[],datatargetsOptionsEs:[],pickerOptionsStart:{disabledDate:function(a){if("Run Once"===t.scheduleType)return a.getTime()<o()().startOf("day").format("x");var e=t.scheduleData.endDate;return e?a.getTime()>new Date(e).getTime():void 0}},pickerOptionsEnd:{disabledDate:function(a){var e=t.scheduleData.startDate;if(e)return a.getTime()<=new Date(e).getTime()-864e5}}}},created:function(){this.getList(),this.getPipelines()},methods:{changePipeline:function(){this.dialogVisible=!0,this.$refs.upload.clearFiles(),this.fileList=[]},uploadFile:function(){if(0===this.fileList.length)return this.$message.warning("Please select file"),!1;this.uploadLoading=!0,this.$refs.upload.submit()},uploadError:function(){this.$message.error("Upload fail,please check"),this.uploadLoading=!1},uploadSuccess:function(){this.dialogVisible=!1,this.uploadLoading=!1,this.modelCLose=!0,this.$message.success("Upload success!")},beforeRemove:function(t,a){return this.$confirm("Are you sure to delete ".concat(t.name,"?"))},handleChange:function(t,a){this.fileList=a,this.modelCLose=!1},removeFile:function(){this.fileList=[]},select_status:function(){this.$forceUpdate()},setSchedule:function(){this.buttonDisabled=!1,this.scheduleData.startDate="",this.scheduleData.endDate=""},valideStartDate:function(){"Run Once"===this.scheduleType&&new Date(this.scheduleData.startDate)<=new Date?(this.$message.error("Start time is less than now"),this.buttonDisabled=!0):this.buttonDisabled=!1},valideDate:function(){"Run Once"!==this.scheduleType&&new Date(this.scheduleData.startDate)>new Date(this.scheduleData.endDate)?(this.$message.error("Start time is greater than end time"),this.buttonDisabled=!0):this.buttonDisabled=!1},setNumber:function(){this.addData.sharding=this.addData.sharding.replace(/[^1-9]/g,""),this.addData.sharding=this.addData.sharding.replace(".","")},setScheduleShow:function(t){switch(t.recurrence){case"None":return'Run once on <span class="f16 color-green disibblock fb"> '.concat(o()(t.startDate).format("YYYY-MM-DD"),' </span>, at  <span class="f16 color-green disibblock fb"> ').concat(o()(t.startDate).format("HH:mm:ss")," </span>");case"Daily":return'Starting from <span class="f16 color-green disibblock fb"> '.concat(o()(t.startDate).format("YYYY-MM-DD"),' </span>, every day at <span class="f16 color-green disibblock fb"> ').concat(o()(t.startDate).format("HH:mm:ss"),' </span>, until <span class="f16 color-green disibblock fb"> ').concat(o()(t.endDate).format("YYYY-MM-DD")," </span>");case"Weekly":return'Starting from <span class="f16 color-green disibblock fb"> '.concat(o()(t.startDate).format("YYYY-MM-DD")," </span>, ").concat(t.weekDays.join(","),' days of every week  at <span class="f16 color-green disibblock fb"> ').concat(o()(t.startDate).format("HH:mm:ss"),' </span>, until <span class="f16 color-green disibblock fb"> ').concat(o()(t.endDate).format("YYYY-MM-DD")," </span>");case"Monthly":return'Starting from <span class="f16 color-green disibblock fb"> '.concat(o()(t.startDate).format("YYYY-MM-DD"),' </span>, day <span class="f16 color-green disibblock fb">').concat(t.day,'</span> of every month at <span class="f16 color-green disibblock fb"> ').concat(o()(t.startDate).format("HH:mm:ss"),' </span>, until <span class="f16 color-green disibblock fb"> ').concat(o()(t.endDate).format("YYYY-MM-DD")," </span>");case"Yearly":return'Starting from <span class="f16 color-green disibblock fb"> '.concat(o()(t.startDate).format("YYYY-MM-DD"),' </span>, monitor the datasource, until <span class="f16 color-green disibblock fb"> ').concat(o()(t.endDate).format("YYYY-MM-DD")," </span>\n")}},delSchedule:function(t){this.saveResultData.schedule.splice(t,1),this.scheduleAllData.splice(t,1)},setWeek:function(t){var a=this,e=[];return t.map((function(t){e.push(a.switchWeek(t))})),e.join(",")},switchWeek:function(t){switch(t){case 0:return"Sun";case 1:return"Mon";case 2:return"Tue";case 3:return"Wed";case 4:return"Thu";case 5:return"Fri";case 6:return"Sat"}},addScheduleData:function(){var t=this;if("Run Once"===this.scheduleType){var a={id:0,startDate:o()(this.scheduleData.startDate).utc().format(),recurrence:0,endDate:"",weekDays:[],time:o()(this.scheduleData.time).valueOf(),disabled:!1};if(!this.scheduleData.startDate)return this.$message.error("Please select start date."),!1}else if("Daily"===this.scheduleType){a={id:0,startDate:o()(this.scheduleData.startDate).utc().format(),recurrence:1,endDate:o()(this.scheduleData.endDate).utc().format(),weekDays:[],time:o()(this.scheduleData.time).valueOf(),disabled:!1};if(!this.scheduleData.startDate||!this.scheduleData.endDate)return this.$message.error("Please select start date and end date."),!1}else if("Weekly"===this.scheduleType){a={id:0,startDate:o()(this.scheduleData.startDate).utc().format(),recurrence:2,endDate:o()(this.scheduleData.endDate).utc().format(),weekDays:this.scheduleData.weekDays,time:o()(this.scheduleData.time).valueOf(),disabled:!1};if(!this.scheduleData.startDate||!this.scheduleData.endDate||0===this.scheduleData.weekDays.length)return this.$message.error("Please select start date and end date and weeks. "),!1}else if("Monthly"===this.scheduleType){a={id:0,startDate:o()(this.scheduleData.startDate).utc().format(),day:this.scheduleData.day,recurrence:3,endDate:o()(this.scheduleData.endDate).utc().format(),weekDays:[],time:o()(this.scheduleData.time).valueOf(),disabled:!1};if(!this.scheduleData.startDate||!this.scheduleData.endDate||!this.scheduleData.day)return this.$message.error("Please select start date and end date and day. "),!1}else if("Monitor"===this.scheduleType){a={id:0,startDate:o()(this.scheduleData.startDate).utc().format(),recurrence:4,endDate:o()(this.scheduleData.endDate).format(),weekDays:[],disabled:!1};if(!this.scheduleData.startDate||!this.scheduleData.endDate)return this.$message.error("Please select start date and end date. "),!1}this.scheduleAllData.push(a),this.saveResultData.schedule=this.scheduleAllData,this.addDataLoading=!0,O(this.saveResultData.id,this.saveResultData).then((function(a){200===a.code&&(t.$message({type:"success",message:"Success!"}),t.scheduleData.startDate="",t.scheduleData.time="",t.scheduleData.day="",t.scheduleData.endDate="",t.scheduleData.weekDays=[],t.saveResultData=a.data,t.addDataLoading=!1)}))},getPipelines:function(){var t=this,a={page:0,q:"",size:1e3};y(a).then((function(a){200===a.code&&(t.pipelinesOptions=a.data,t.uploadData.uid=a.data[0].uid)}))},getDatasources:function(){var t=this,a={page:0,q:"",size:1e3};k(a).then((function(a){t.datasourcesOptions=a.data}))},getDatatargets:function(){var t=this,a={page:0,q:"",size:1e3};_(a).then((function(a){t.datatargetsOptions=a.data;var e=[],s=[];a.data.map((function(t){"DATABASE"===t.trgType?e.push(t):"ELASTICSEARCH"===t.trgType&&s.push(t)})),t.datatargetsOptionsDb=e,t.datatargetsOptionsEs=s,t.addData.datatargetEs=s[0].name}))},changeSourceData:function(){var t=this,a=[],e=[];this.sourceTestData.map((function(s){if(s.name===t.addData.tblName){var n=Object.values(s.columns);n.map((function(t){"VARCHAR"===t.typeName?a.push(t.name):"DATETIME"===t.typeName&&e.push(t.name)}))}})),this.sourceTextOptions=a,this.sourceModifiedOptions=e},getSourceData:function(){var t=this;if(0===this.sourceTableOptions.length){var a={uri:this.addData.url,username:this.addData.username?this.addData.username:"null",password:this.addData.password?this.addData.password:"null",driver:this.addData.driver?this.addData.driver:"null"};S(a).then((function(a){var e=Object.values(a.data.tables);t.sourceTestData=e;var s=[];e.map((function(t){"TABLE"===t.type&&s.push(t.name)})),t.sourceTableOptions=s}))}},selectType:function(){"ElESTICSEARCH"===this.addData.srcType?this.databaseShow=!1:this.databaseShow=!0},changeDataBtn:function(t){var a=this;this.dataEidtStatus=!0,this.dataCreatNew=!0,this.addDataLoading=!0,this.getPipelines(),this.getDatasources(),this.getDatatargets(),T(t.id).then((function(t){a.addData=t.data,a.addData.pipeline=t.data.pipeline.name,a.addData.datasources=t.data.datasource.name,a.addData.datatargets=t.data.datatarget?t.data.datatarget.name:"",a.addData.datatargetEs=t.data.datatargetEs?t.data.datatargetEs.name:"",a.addDataLoading=!1,a.creatNewActive=0,a.scheduleAllData=t.data.schedule,a.scheduleType="Run Once"}))},delData:function(t){var a=this;this.$confirm("Are you sure you want to delete data?",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then((function(){E(t.id).then((function(t){200===t.code&&(a.$message({type:"success",message:"Delete Success!"}),a.getList())}))})).catch((function(){}))},dataSaerchBtn:function(){this.searchData.dataName=this.searchData.dataName?this.searchData.dataName.trim():null,this.dataPage=1,this.getList()},saveDataBtn:function(){var t=this;this.addDataLoading=!0,O(this.saveResultData.id,this.saveResultData).then((function(a){t.$message({type:"success",message:"Success!"}),t.dataCreatNew=!1,t.addDataLoading=!1,t.getList()}))},nextDataBtn:function(t){var a=this;this.$refs[t].validate((function(t){if(!t)return!1;if(!a.addData.datatargets&&!a.addData.datatargetEs)return a.$message.error("Please select DBTarget or ESTarget."),!1;if(a.addDataLoading=!0,a.dataEidtStatus){var e={name:a.addData.name,description:a.addData.description,id:a.addData.id,datasource:a.getDatasourceObj(),datatarget:a.getDatatargetsObj(),datatargetEs:a.getDatatargetEsObj(),pipeline:a.getPipelineObj(),sharding:a.addData.sharding,schedule:a.addData.schedule};a.addDataLoading=!0,O(a.addData.id,e).then((function(t){200===t.code?(a.creatNewActive=1,a.saveResultData=t.data,a.addDataLoading=!1):(a.$message.error(t.message),a.addDataLoading=!1)}))}else{var s={name:a.addData.name,description:a.addData.description,id:0,datasource:a.getDatasourceObj(),datatarget:a.getDatatargetsObj(),datatargetEs:a.getDatatargetEsObj(),pipeline:a.getPipelineObj(),sharding:a.addData.sharding};x(s).then((function(t){200===t.code&&(a.creatNewActive=1,a.saveResultData=t.data,a.addDataLoading=!1)})).catch((function(){a.addDataLoading=!1}))}}))},getDatasourceObj:function(){var t=this,a={};return this.datasourcesOptions.map((function(e){e.name===t.addData.datasources&&(a=e)})),this.addData.datasources?a:null},getDatatargetsObj:function(){var t=this,a={};return this.datatargetsOptions.map((function(e){e.name===t.addData.datatargets&&(a=e)})),this.addData.datatargets?a:null},getDatatargetEsObj:function(){var t=this,a={};return this.datatargetsOptions.map((function(e){e.name===t.addData.datatargetEs&&(a=e)})),this.addData.datatargetEs?a:null},getPipelineObj:function(){var t=this,a={};return this.pipelinesOptions.map((function(e){e.name===t.addData.pipeline&&(a=e)})),a},addDataBtn:function(){this.dataCreatNew=!0,this.dataEidtStatus=!1,this.scheduleAllData=[],this.getPipelines(),this.getDatasources(),this.getDatatargets(),this.addData={name:"",description:"",id:0,datasource:"",datatarget:"",datatargetEs:"",pipeline:"",sharding:""},this.saveResultData.schedule=[],this.scheduleType="Run Once",this.scheduleData.startDate="",this.scheduleData.time="",this.scheduleData.day="",this.scheduleData.endDate="",this.scheduleData.weekDays=[],this.creatNewActive=0},changeDataRole:function(t){var a=this;this.changeData.roleId=[],t.forEach((function(t){a.rolesOptions.forEach((function(e){t===e.roleName&&a.changeData.roleId.push(e.id)}))}))},handleCurrentChange:function(t){this.page=t-1,this.getList()},handleFilter:function(){this.getList()},getList:function(){var t=this;this.listLoading=!0;var a={page:this.page,size:10,name:this.searchData.name};w(a).then((function(a){200===a.code&&(t.list=a.data.content,t.listLoading=!1,t.total=a.data.totalElements)}))},cancelEdit:function(t){t.title=t.originalTitle,t.edit=!1,this.$message({message:"The title has been restored to the original value",type:"warning"})},confirmEdit:function(t){t.edit=!1,t.originalTitle=t.title,this.$message({message:"The title has been edited",type:"success"})},getRolesList:function(){var t=this;C().then((function(a){200===a.code&&(t.rolesOptions=a.data)}))},resetForm:function(t){this.$refs[t].resetFields(),this.changeData.roleId&&(this.changeData.roleId=[])}}},N=L,R=(e("e32d"),Object(m["a"])(N,g,b,!1,null,null,null)),A=R.exports,$=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("nav",{staticClass:"vital-container cb"},[e("strong",{staticClass:"fl nav-title mt-10 f16"},[t._v("Data sources")]),t._v(" "),e("div",{staticClass:"fr"},[e("el-input",{staticClass:"radius-input search-input mr-15",attrs:{size:"medium",clearable:"",placeholder:"Please enter the keyword"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.dataSaerchBtn(a)}},model:{value:t.searchData.name,callback:function(a){t.$set(t.searchData,"name",a)},expression:"searchData.name"}},[e("i",{staticClass:"el-input__icon el-icon-search cp",attrs:{slot:"suffix",title:"Search"},on:{click:t.dataSaerchBtn},slot:"suffix"})]),t._v(" "),e("el-button",{staticClass:"filter-item shadow",attrs:{type:"primary",size:"medium",icon:"el-icon-plus"},on:{click:t.addDataBtn}},[t._v("Add")])],1)]),t._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticClass:"mt-20 table-content",staticStyle:{width:"100%"},attrs:{data:t.list,fit:"","highlight-current-row":""}},[e("no-data-table",{attrs:{slot:"empty"},slot:"empty"}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"Datasource Id",width:"130",prop:"id"}}),t._v(" "),e("el-table-column",{attrs:{width:"210px",label:"Name"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.name))])]}}])}),t._v(" "),e("el-table-column",{attrs:{"min-width":"100px",align:"center",label:"Type"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.srcType))])]}}])}),t._v(" "),e("el-table-column",{attrs:{"min-width":"200px",label:"\tDate"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n        "+t._s(t._f("setHourDate")(a.row.date))+"\n      ")]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"Operation",width:"250px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("i",{staticClass:"iconfont el-icon-edit color-main cp mr-10",attrs:{title:"Edit"},on:{click:function(e){return e.stopPropagation(),t.changeDataBtn(a.row)}}}),t._v(" "),e("i",{staticClass:"iconfont icon-shanchu color-red cp",attrs:{title:"Delete"},on:{click:function(e){return e.stopPropagation(),t.delData(a.row)}}})]}}])})],1),t._v(" "),e("div",{staticClass:"tr mt-25"},[e("el-pagination",{attrs:{background:"","page-size":10,"hide-on-single-page":"",layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),e("el-dialog",{attrs:{visible:t.dataCreatNew,"close-on-click-modal":t.modelCLose,title:t.dataEidtStatus?"Edit Datasource":"Add Datasource",width:"58%"},on:{"update:visible":function(a){t.dataCreatNew=a}}},[e("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.addDataDialog,expression:"addDataDialog"}],ref:"addData",staticClass:"mt-10",attrs:{model:t.addData,"label-width":"148px",rules:t.dataRules}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Name:",prop:"name",rules:[{required:!0,message:"Please enter name",trigger:"blur"}]}},[e("el-input",{attrs:{placeholder:"Please enter name"},model:{value:t.addData.name,callback:function(a){t.$set(t.addData,"name",a)},expression:"addData.name"}})],1)],1)],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Description:",prop:"dataName"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:3},placeholder:"Please enter date"},model:{value:t.addData.description,callback:function(a){t.$set(t.addData,"description",a)},expression:"addData.description"}})],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:19}},[e("el-form-item",{attrs:{label:"URL/Path:"}},[e("el-input",{attrs:{placeholder:"Please enter URL/Path"},model:{value:t.addData.url,callback:function(a){t.$set(t.addData,"url",a)},expression:"addData.url"}}),t._v(" "),e("div",{staticClass:"f12 color-8"},[t._v("\n              Enter appropriate folder or URL for your data source based on\n              datasource type.\n            ")])],1)],1),t._v(" "),e("el-col",{staticClass:"tr",attrs:{span:3}},[e("el-button",{attrs:{loading:t.testLoading,type:"danger"},on:{click:t.testUrl}},[t._v("Test")])],1)],1),t._v(" "),t.databaseShow?e("div",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"JDBC Driver name:"}},[e("el-input",{attrs:{placeholder:"Please enter JDBC Driver name"},model:{value:t.addData.driver,callback:function(a){t.$set(t.addData,"driver",a)},expression:"addData.driver"}})],1)],1),t._v(" "),e("el-col",{attrs:{span:10}},[e("el-form-item",{attrs:{label:"Username:",prop:"userName"}},[e("el-input",{attrs:{placeholder:"Please enter Username"},model:{value:t.addData.username,callback:function(a){t.$set(t.addData,"username",a)},expression:"addData.username"}})],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Password:"}},[e("el-input",{attrs:{type:"password",placeholder:"Please enter JDBC Driver Password"},model:{value:t.addData.password,callback:function(a){t.$set(t.addData,"password",a)},expression:"addData.password"}})],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Source tablename:",prop:"tblName",rules:[{required:!0,message:"Please enter name"}]}},[e("el-select",{attrs:{"no-data-text":"no data",placeholder:"Please select"},on:{change:t.changeSourceData},model:{value:t.addData.tblName,callback:function(a){t.$set(t.addData,"tblName",a)},expression:"addData.tblName"}},t._l(t.sourceTableOptions,(function(t,a){return e("el-option",{key:a,attrs:{label:t,value:t}})})),1)],1)],1),t._v(" "),e("el-col",{attrs:{span:10}},[e("el-form-item",{attrs:{label:"Document id:",prop:"idCol",rules:[{required:!0,message:"Please enter name"}]}},[e("el-select",{attrs:{"no-data-text":"no data",placeholder:"Please select"},on:{change:t.setSqlData},model:{value:t.addData.idCol,callback:function(a){t.$set(t.addData,"idCol",a)},expression:"addData.idCol"}},t._l(t.sourceTextOptions,(function(t,a){return e("el-option",{key:a,attrs:{label:t,value:t}})})),1)],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Patient id:",prop:"patientCol",rules:[{required:!0,message:"Please enter name"}]}},[e("el-select",{attrs:{"no-data-text":"no data",placeholder:"Please select"},on:{change:t.setSqlData},model:{value:t.addData.patientCol,callback:function(a){t.$set(t.addData,"patientCol",a)},expression:"addData.patientCol"}},t._l(t.sourceTextOptions,(function(t,a){return e("el-option",{key:a,attrs:{label:t,value:t}})})),1)],1)],1),t._v(" "),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Time stamp:",prop:"timeStampCol",rules:[{required:!0,message:"Please enter name"}]}},[e("el-select",{attrs:{"no-data-text":"no data",placeholder:"Please select"},on:{change:t.setSqlData},model:{value:t.addData.timeStampCol,callback:function(a){t.$set(t.addData,"timeStampCol",a)},expression:"addData.timeStampCol"}},t._l(t.sourceTextOptions,(function(t,a){return e("el-option",{key:a,attrs:{label:t,value:t}})})),1)],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Text field:",prop:"textCol",rules:[{required:!0,message:"Please enter name"}]}},[e("el-select",{attrs:{"no-data-text":"no data",placeholder:"Please select"},on:{change:t.setSqlData},model:{value:t.addData.textCol,callback:function(a){t.$set(t.addData,"textCol",a)},expression:"addData.textCol"}},t._l(t.sourceTextOptions,(function(t,a){return e("el-option",{key:a,attrs:{label:t,value:t}})})),1)],1)],1),t._v(" "),e("el-col",{attrs:{span:10}},[e("el-form-item",{attrs:{label:"Document date:",prop:"dateCol",rules:[{required:!0,message:"Please enter name"}]}},[e("el-select",{attrs:{"no-data-text":"no data",placeholder:"Please select"},on:{change:t.setSqlData},model:{value:t.addData.dateCol,callback:function(a){t.$set(t.addData,"dateCol",a)},expression:"addData.dateCol"}},t._l(t.sourceTextOptions,(function(t,a){return e("el-option",{key:a,attrs:{label:t,value:t}})})),1)],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Document type:",prop:"categoryCol",rules:[{required:!0,message:"Please enter name"}]}},[e("el-select",{attrs:{"no-data-text":"no data",placeholder:"Please select"},on:{change:t.setSqlData},model:{value:t.addData.categoryCol,callback:function(a){t.$set(t.addData,"categoryCol",a)},expression:"addData.categoryCol"}},t._l(t.sourceTextOptions,(function(t,a){return e("el-option",{key:a,attrs:{label:t,value:t}})})),1)],1)],1)],1),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"SQL:"}},[e("codemirror",{attrs:{options:t.cmOptions},model:{value:t.addData.sql,callback:function(a){t.$set(t.addData,"sql",a)},expression:"addData.sql"}})],1)],1)],1)],1):t._e()],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"btn-white shadow",on:{click:function(a){t.dataCreatNew=!1}}},[t._v("\n        Cancel")]),t._v(" "),e("el-button",{staticClass:"btn-orange shadow",attrs:{disabled:t.allowSave,type:"primary"},on:{click:function(a){return t.saveDataBtn("addData")}}},[t._v("\n        Save")])],1)],1)],1)},P=[];function Y(t){return Object(d["a"])({url:"api/datasources/byName",method:"GET",params:t})}function I(t){return Object(d["a"])({url:"api/test-uri",method:"post",params:t})}function j(t){return Object(d["a"])({url:"api/datasources/".concat(t),method:"GET"})}function M(t,a){return Object(d["a"])({url:"api/datasources/".concat(t),method:"put",data:a})}function B(t){return Object(d["a"])({url:"api/datasources",method:"post",data:t})}function H(t){return Object(d["a"])({url:"api/datasources/".concat(t),method:"delete"})}var q=e("8a2b"),F={name:"InlineEditTable",components:{codemirror:q["codemirror"]},data:function(){return{dataCreatNew:!1,addDataDialog:!1,dataEidtStatus:!1,modelCLose:!0,databaseShow:!1,testLoading:!1,allowSave:!0,typeOptions:[{label:"Local File",value:"FILE"},{label:"Database",value:"DATABASE"}],addData:{type:"FILE",id:0,url:"",name:"",description:"",username:"",password:"",driver:"com.mysql.jdbc.Driver"},cmOptions:{tabSize:4,mode:"SQL",theme:"base16-dark",lineNumbers:!0,line:!0},rolesOptions:[],dataRules:{dataLoginName:[{required:!0,message:"Please enter name",trigger:"blur"}]},changeData:{name:"",loginName:"",tel:"",department:"",email:"",roles:[],roleId:[],id:""},list:[],loading:!1,listLoading:!1,viewDataData:{},page:0,total:0,searchData:{dataLoginName:"",name:null,dataRoleName:"",dataStatus:""},sourceTestData:[],sourceTableOptions:[],sourceTableData:[],sourceTextOptions:[],sourceModifiedOptions:[],contentArr:[]}},created:function(){this.getList()},methods:{setSqlData:function(){var t=[this.addData.idCol,this.addData.patientCol,this.addData.timeStampCol,this.addData.textCol,this.addData.dateCol,this.addData.categoryCol],a=[];t.map((function(t){t&&a.push(t)})),this.addData.sql="select ".concat(a.join(",")," from ").concat(this.addData.tblName)},changeSourceData:function(t){"edit"!==t&&(this.addData.idCol="",this.addData.patientCol="",this.addData.textCol="",this.addData.dateCol="",this.addData.timeStampCol="",this.addData.categoryCol=""),this.sourceTextOptions=this.sourceTableData[this.addData.tblName]},testUrl:function(t){var a=this;if(this.addData.url){this.modelCLose=!1;var e={srcType:this.addData.srcType,uri:this.addData.url,username:this.addData.username?this.addData.username:"null",password:this.addData.password?this.addData.password:"null",driver:this.addData.driver?this.addData.driver:"null"};this.testLoading=!0,this.allowSave=!0,I(e).then((function(e){200===e.code?(a.$message.success("Test succeeded."),a.sourceTableData=e.data.tables,a.sourceTableOptions=Object.keys(e.data.tables),a.testLoading=!1,a.allowSave=!1,t()):(a.$message.warning(e.message),a.testLoading=!1,a.allowSave=!0)})).catch((function(){a.testLoading=!1}))}else this.$message.error("Please enter the URL.")},selectType:function(){"FILE"==this.addData.srcType?this.databaseShow=!1:(this.databaseShow=!0,this.addData.driver="com.mysql.jdbc.Driver")},changeDataBtn:function(t){var a=this;this.dataEidtStatus=!0,this.dataCreatNew=!0,this.addDataDialog=!0,this.testLoading=!1,j(t.id).then((function(t){200===t.code&&(a.addData=t.data,a.addDataDialog=!1,a.selectType(),"DATABASE"===t.data.srcType&&a.testUrl((function(){a.changeSourceData("edit")})))}))},delData:function(t){var a=this;this.$confirm("Are you sure you want to delete data?",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then((function(){H(t.id).then((function(t){200===t.code&&(a.$message({type:"success",message:"Delete Success!"}),a.getList())}))})).catch((function(){}))},dataSaerchBtn:function(){this.searchData.dataName=this.searchData.dataName?this.searchData.dataName.trim():null,this.dataPage=1,this.getList()},saveDataBtn:function(t){var a=this;this.$refs[t].validate((function(t){if(!t)return!1;if(a.dataEidtStatus){if("FILE"==a.addData.srcType)var e={date:a.addData.date,disabled:a.addData.disabled,description:a.addData.description,id:a.addData.id,srcType:a.addData.srcType,name:a.addData.name,url:a.addData.url,uid:a.addData.uid};else e={date:a.addData.date,disabled:a.addData.disabled,description:a.addData.description,srcType:a.addData.srcType,name:a.addData.name,url:a.addData.url,dateCol:a.addData.dateCol,driver:a.addData.driver,groupId:0,id:a.addData.id,idCol:a.addData.idCol,password:a.addData.password,patientCol:a.addData.patientCol,sql:a.addData.sql,tblName:a.addData.tblName,textCol:a.addData.textCol,timeStampCol:a.addData.timeStampCol,categoryCol:a.addData.categoryCol,uid:a.addData.uid,userId:0,username:a.addData.username};M(a.addData.id,e).then((function(t){200===t.code&&(a.$message({type:"success",message:"Success!"}),a.dataCreatNew=!1,a.modelCLose=!0,a.resetForm("addData"),a.getList())}))}else{if("FILE"==a.addData.srcType)var s={description:a.addData.description,id:a.addData.id,srcType:a.addData.srcType,name:a.addData.name,url:a.addData.url};else s={description:a.addData.description,srcType:a.addData.srcType,name:a.addData.name,url:a.addData.url,dateCol:a.addData.dateCol,disabled:!1,driver:a.addData.driver,groupId:0,id:0,idCol:a.addData.idCol,password:a.addData.password,patientCol:a.addData.patientCol,sql:a.addData.sql,tblName:a.addData.tblName,textCol:a.addData.textCol,timeStampCol:a.addData.timeStampCol,categoryCol:a.addData.categoryCol,uid:"",userId:0,username:a.addData.username};B(s).then((function(t){200===t.code&&(a.dataCreatNew=!1,a.modelCLose=!0,a.getList())}))}}))},addDataBtn:function(){this.dataCreatNew=!0,this.dataEidtStatus=!1,this.testLoading=!1,this.allowSave=!0,this.addData={description:"",srcType:"DATABASE",name:"",url:"",dateCol:"",disabled:!1,driver:"",groupId:0,id:0,idCol:"",password:"",patientCol:"",sql:"",tblName:"",textCol:"",timeStampCol:"",categoryCol:"",uid:"",userId:0,username:""},this.selectType(),this.sourceTableOptions=[],this.sourceTextOptions=[],this.resetForm("addData")},changeDataRole:function(t){var a=this;this.changeData.roleId=[],t.forEach((function(t){a.rolesOptions.forEach((function(e){t==e.roleName&&a.changeData.roleId.push(e.id)}))}))},handleCurrentChange:function(t){this.page=t-1,this.getList()},handleFilter:function(){this.getList()},getList:function(){var t=this;this.listLoading=!0;var a={page:this.page,size:10,name:this.searchData.name};Y(a).then((function(a){200===a.code&&(t.list=a.data.content,t.listLoading=!1,t.total=a.data.totalElements)}))},resetForm:function(t){this.$refs[t].resetFields()}}},z=F,U=Object(m["a"])(z,$,P,!1,null,"6d492c95",null),W=U.exports,G=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("nav",{staticClass:"vital-container cb"},[e("strong",{staticClass:"fl nav-title mt-10 f16"},[t._v("Workers")]),t._v(" "),e("div",{staticClass:"fr"},[e("el-input",{staticClass:"radius-input search-input mr-15",attrs:{size:"medium",clearable:"",placeholder:"Please enter the keyword"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.dataSaerchBtn(a)}},model:{value:t.searchData.name,callback:function(a){t.$set(t.searchData,"name","string"===typeof a?a.trim():a)},expression:"searchData.name"}},[e("i",{staticClass:"el-input__icon el-icon-search cp",attrs:{slot:"suffix",title:"Search"},on:{click:t.dataSaerchBtn},slot:"suffix"})])],1)]),t._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticClass:"mt-20 table-content",staticStyle:{width:"100%"},attrs:{data:t.list,fit:"","highlight-current-row":""}},[e("no-data-table",{attrs:{slot:"empty"},slot:"empty"}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"Worker Id",width:"130",prop:"id"}}),t._v(" "),e("el-table-column",{attrs:{width:"210px",label:"Name"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.name))])]}}])}),t._v(" "),e("el-table-column",{attrs:{"min-width":"100px",align:"center",label:"Status"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.status))])]}}])}),t._v(" "),e("el-table-column",{attrs:{"min-width":"200px",label:"\tDate"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n        "+t._s(t._f("setHourDate")(a.row.date))+"\n      ")]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"Operation",width:"250px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Click set disabled",placement:"top-start"}},[a.row.disabled?t._e():e("el-button",{staticClass:"color-green f22",attrs:{type:"text",icon:"el-icon-circle-check"},on:{click:function(e){return t.changeStatue(a.row)}}})],1),t._v(" "),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Click set enabled",placement:"top-start"}},[a.row.disabled?e("el-button",{staticClass:"color-red f22",attrs:{type:"text",icon:"el-icon-circle-close"},on:{click:function(e){return t.changeStatue(a.row)}}}):t._e()],1)]}}])})],1),t._v(" "),e("div",{staticClass:"tr mt-25"},[e("el-pagination",{attrs:{background:"","hide-on-single-page":"","page-size":10,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),e("el-dialog",{attrs:{visible:t.dataCreatNew,width:"58%"},on:{"update:visible":function(a){t.dataCreatNew=a}}},[e("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.dataEidtStatus?"Edit Worker":"Add Worker"))]),t._v(" "),e("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.addDataDialog,expression:"addDataDialog"}],ref:"addData",attrs:{model:t.addData,"label-width":"148px",rules:t.dataRules}},[t.dataEidtStatus?e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Worker Id:",prop:"dataLoginName"}},[e("el-input",{attrs:{disabled:"",placeholder:"Please enter Worker Id"},model:{value:t.addData.id,callback:function(a){t.$set(t.addData,"id",a)},expression:"addData.id"}})],1)],1),t._v(" "),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Date:"}},[e("el-date-picker",{attrs:{disabled:"",type:"datetime",placeholder:""},model:{value:t.addData.date,callback:function(a){t.$set(t.addData,"date",a)},expression:"addData.date"}})],1)],1)],1):t._e(),t._v(" "),t.dataEidtStatus?e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"Uid:"}},[e("el-input",{attrs:{disabled:"",placeholder:"Please enter Worker Id"},model:{value:t.addData.uid,callback:function(a){t.$set(t.addData,"uid",a)},expression:"addData.uid"}})],1)],1)],1):t._e(),t._v(" "),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Name:",prop:"name"}},[e("el-input",{attrs:{placeholder:"Please enter name"},model:{value:t.addData.name,callback:function(a){t.$set(t.addData,"name",a)},expression:"addData.name"}})],1)],1)],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Description:",prop:"dataName"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:3},placeholder:"Please enter date"},model:{value:t.addData.description,callback:function(a){t.$set(t.addData,"description",a)},expression:"addData.description"}})],1)],1)],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Upload:",prop:"disabled"}},[e("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{headers:t.uploadHeader,accept:".jar",data:t.uploadData,"file-list":t.fileList,drag:"",action:"/api/upload","auto-upload":!1}},[e("i",{staticClass:"el-icon-upload"}),t._v(" "),e("div",{staticClass:"el-upload__text"},[t._v("\n                Drag the file here , or "),e("em",[t._v("click upload")])])])],1)],1)],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Disabled:",prop:"disabled"}},[e("el-checkbox",{model:{value:t.addData.disabled,callback:function(a){t.$set(t.addData,"disabled",a)},expression:"addData.disabled"}})],1)],1)],1)],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"btn-orange shadow",attrs:{type:"primary"},on:{click:function(a){return t.saveDataBtn("addData")}}},[e("i",{staticClass:"iconfont icon-save f14 mr-5"}),t._v("Save")]),t._v(" "),e("el-button",{staticClass:"btn-white shadow",on:{click:function(a){t.dataCreatNew=!1}}},[e("i",{staticClass:"iconfont icon-reset mr-5 f14"}),t._v("Cancel")])],1)],1)],1)},V=[];function J(t){return Object(d["a"])({url:"api/workers/byName",method:"GET",params:t})}function Q(t){return Object(d["a"])({url:"api/workers/".concat(t),method:"GET"})}function K(t,a){return Object(d["a"])({url:"api/workers/".concat(t),method:"put",data:a})}function X(t){return Object(d["a"])({url:"api/workers",method:"post",data:t})}var Z={name:"InlineEditTable",components:{codemirror:q["codemirror"]},filters:{statusFilter:function(t){return"停用"==t?"danger":"启用"==t?"success":void 0},setDate:function(t){return o()(t).utcOffset(2*-(new Date).getTimezoneOffset()).format("YYYY-MM-DD HH:mm:ss")},setStatus:function(t){switch(t){case 0:return"UNKNOWN";case 1:return"IDLE";case 2:return"PENDING";case 3:return"ACTIVE";case 4:return"COMPLETE";case 5:return"ERROR";case 6:return"INACCESSIBLE"}}},data:function(){return{dataCreatNew:!1,addDataDialog:!1,dataEidtStatus:!1,databaseShow:!1,fileList:[],uploadHeader:{Authorization:"Bearer "+v["a"].getters.token},uploadData:{uid:""},typeOptions:[{label:"Elesticsearch",value:"ElESTICSEARCH"},{label:"Database",value:"DATABASE"}],addData:{type:"ElESTICSEARCH",id:0,url:"",name:"",description:"",username:"",password:"",driver:""},cmOptions:{tabSize:4,mode:"text/javascript",theme:"base16-dark",lineNumbers:!0,line:!0},rolesOptions:[],dataRules:{},changeData:{name:"",loginName:"",tel:"",department:"",email:"",roles:[],roleId:[],id:""},list:[],loading:!1,listLoading:!1,viewDataData:{},page:0,total:0,searchData:{dataLoginName:"",name:null,dataRoleName:"",dataStatus:""},sourceTestData:[],sourceTableOptions:[],sourceTextOptions:[],sourceModifiedOptions:[]}},created:function(){this.getList()},methods:{changeStatue:function(t){var a=this;Q(t.id).then((function(e){200===e.code&&(a.addData=e.data,a.addData.disabled=!t.disabled,K(t.id,a.addData).then((function(t){200===t.code&&(a.$message({type:"success",message:"Success!"}),a.getList())})))}))},changeSourceData:function(){var t=this,a=[],e=[];this.sourceTestData.map((function(s){if(s.name===t.addData.tblName){var n=Object.values(s.columns);n.map((function(t){"VARCHAR"===t.typeName?a.push(t.name):"DATETIME"===t.typeName&&e.push(t.name)}))}})),this.sourceTextOptions=a,this.sourceModifiedOptions=e},selectType:function(){"ElESTICSEARCH"==this.addData.srcType?this.databaseShow=!1:this.databaseShow=!0},dataSaerchBtn:function(){this.searchData.dataName=this.searchData.dataName?this.searchData.dataName.trim():null,this.dataPage=1,this.getList()},saveDataBtn:function(t){var a=this;this.$refs[t].validate((function(t){if(!t)return!1;if(a.dataEidtStatus){var e={date:a.addData.date,disabled:a.addData.disabled,description:a.addData.description,id:a.addData.id,name:a.addData.name,uid:a.addData.uid};K(a.addData.id,e).then((function(t){200===t.code&&(a.$message({type:"success",message:"Success!"}),a.dataCreatNew=!1,a.resetForm("addData"),a.getList())}))}else{if("ElESTICSEARCH"==a.addData.srcType)var s={description:a.addData.description,disabled:a.addData.disabled,id:0,name:a.addData.name};X(s).then((function(t){200===t.code&&(a.uploadData.uid=t.data.uid,a.$refs.upload.submit())}))}}))},addDataBtn:function(){this.dataCreatNew=!0,this.dataEidtStatus=!1,this.addData={description:"",srcType:"ElESTICSEARCH",name:"",url:"",entTbl:"",disabled:!1,driver:"",groupId:0,id:0,idCol:"",password:"",relTbl:"",sql:"",tblName:"",textCol:"",uid:"",userId:0,username:""},this.selectType()},changeDataRole:function(t){var a=this;this.changeData.roleId=[],t.forEach((function(t){a.rolesOptions.forEach((function(e){t==e.roleName&&a.changeData.roleId.push(e.id)}))}))},handleCurrentChange:function(t){this.page=t-1,this.getList()},handleFilter:function(){this.getList()},getList:function(){var t=this;this.listLoading=!0;var a={page:this.page,size:10,name:this.searchData.name};J(a).then((function(a){200===a.code&&(t.list=a.data.content,t.listLoading=!1,t.total=a.data.totalElements)}))},resetForm:function(t){this.$refs[t].resetFields(),this.changeData.roleId&&(this.changeData.roleId=[])}}},tt=Z,at=(e("1f6d"),Object(m["a"])(tt,G,V,!1,null,"2b317402",null)),et=at.exports,st=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("nav",{staticClass:"vital-container cb"},[e("strong",{staticClass:"fl nav-title mt-10 f16"},[t._v("Pipelines")]),t._v(" "),e("div",{staticClass:"fr"},[e("el-input",{staticClass:"radius-input search-input mr-15",attrs:{size:"medium",clearable:"",placeholder:"Please enter the keyword"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.dataSaerchBtn(a)}},model:{value:t.searchData.dataName,callback:function(a){t.$set(t.searchData,"dataName",a)},expression:"searchData.dataName"}},[e("i",{staticClass:"el-input__icon el-icon-search cp",attrs:{slot:"suffix",title:"Search"},on:{click:t.dataSaerchBtn},slot:"suffix"})]),t._v(" "),e("el-button",{staticClass:"filter-item shadow",attrs:{type:"primary",size:"medium",icon:"el-icon-plus"},on:{click:t.addDataBtn}},[t._v("Add")])],1)]),t._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticClass:"mt-20 table-content",staticStyle:{width:"100%"},attrs:{data:t.list,fit:"","highlight-current-row":""}},[e("el-table-column",{attrs:{align:"center",label:"Pipeline Id",width:"130",prop:"id"}}),t._v(" "),e("el-table-column",{attrs:{width:"210px",label:"Name"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.name))])]}}])}),t._v(" "),e("el-table-column",{attrs:{"min-width":"100px",align:"center",label:"Status"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.status))])]}}])}),t._v(" "),e("el-table-column",{attrs:{"min-width":"200px",label:"\tDate"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n        "+t._s(t._f("setHourDate")(a.row.date))+"\n      ")]}}])}),t._v(" "),e("el-table-column",{attrs:{align:"center",label:"Operation",width:"250px"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.changeDataBtn(a.row)}}},[e("i",{staticClass:"iconfont el-icon-edit color-main",attrs:{title:"Edit"}})]),t._v(" "),e("el-button",{staticClass:"color-red",attrs:{type:"text"},on:{click:function(e){return t.delData(a.row)}}},[e("i",{staticClass:"iconfont icon-shanchu color-red",attrs:{title:"Delete"}})])]}}])})],1),t._v(" "),e("div",{staticClass:"tr mt-25"},[e("el-pagination",{attrs:{background:"","hide-on-single-page":"","page-size":10,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),e("el-dialog",{attrs:{visible:t.dataCreatNew,width:"58%",title:t.dataEidtStatus?"Edit Pipeline":"Add Pipeline","close-on-click-modal":t.modelCLose},on:{"update:visible":function(a){t.dataCreatNew=a}}},[e("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.addDataDialog,expression:"addDataDialog"}],ref:"addData",staticClass:"mt-20",attrs:{model:t.addData,"label-width":"148px",rules:t.dataRules}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Name:",prop:"name",rules:[{required:!0,message:"Please enter name",trigger:"blur"}]}},[e("el-input",{attrs:{placeholder:"Please enter name"},model:{value:t.addData.name,callback:function(a){t.$set(t.addData,"name",a)},expression:"addData.name"}})],1)],1)],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Description:",prop:"dataName"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:3},placeholder:"Please enter date"},model:{value:t.addData.description,callback:function(a){t.$set(t.addData,"description",a)},expression:"addData.description"}})],1)],1)],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Upload:",prop:""}},[e("el-upload",{ref:"upload",staticClass:"upload-content",attrs:{headers:t.uploadHeader,accept:".jar","on-change":t.handleChange,"on-success":t.uploadSuccess,data:t.uploadData,drag:"",action:t.baseUrl+"/api/upload",limit:1,"before-remove":t.beforeRemove,"on-remove":t.removeFile,"auto-upload":!1,"file-list":t.fileList}},[e("svg",{staticClass:"icon f65 mt-40 mb-10",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-A"}})]),t._v(" "),e("div",{staticClass:"el-upload__text"},[t._v("\n                Drag the file here,or "),e("em",[t._v("click upload")])])])],1)],1)],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:22}},[e("el-form-item",{attrs:{label:"Disabled:",prop:"disabled"}},[e("el-checkbox",{model:{value:t.addData.disabled,callback:function(a){t.$set(t.addData,"disabled",a)},expression:"addData.disabled"}})],1)],1)],1)],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{staticClass:"btn-white shadow",on:{click:function(a){t.dataCreatNew=!1}}},[t._v("\n        Cancel")]),t._v(" "),e("el-button",{staticClass:"btn-orange shadow",attrs:{loading:t.saveLoading,type:"primary"},on:{click:function(a){return t.saveDataBtn("addData")}}},[t._v("\n        Save")])],1)],1)],1)},nt=[];function it(t){return Object(d["a"])({url:"api/pipelines",method:"GET",params:t})}function lt(t){return Object(d["a"])({url:"api/pipelines/".concat(t),method:"GET"})}function rt(t){return Object(d["a"])({url:"api/pipelines/".concat(t),method:"delete"})}function ot(t,a){return Object(d["a"])({url:"api/pipelines/".concat(t),method:"put",data:a})}function dt(t){return Object(d["a"])({url:"api/pipelines",method:"post",data:t})}var ct={name:"InlineEditTable",filters:{statusFilter:function(t){return"停用"==t?"danger":"启用"==t?"success":void 0},setDate:function(t){return o()(t).utcOffset(2*-(new Date).getTimezoneOffset()).format("YYYY-MM-DD HH:mm:ss")},setStatus:function(t){switch(t){case 0:return"Empty";case 1:return"Uploading";case 2:return"Uploaded";case 3:return"Error"}}},data:function(){return{dataCreatNew:!1,addDataDialog:!1,dataEidtStatus:!1,modelCLose:!0,databaseShow:!1,saveLoading:!1,baseUrl:"/clampee",uploadHeader:{Authorization:"Bearer "+v["a"].getters.token},fileList:[],uploadData:{uid:""},typeOptions:[{label:"Elesticsearch",value:"ElESTICSEARCH"},{label:"Database",value:"DATABASE"}],addData:{type:"ElESTICSEARCH",id:0,url:"",name:"",description:"",username:"",password:"",driver:""},cmOptions:{tabSize:4,mode:"text/javascript",theme:"base16-dark",lineNumbers:!0,line:!0},rolesOptions:[],dataRules:{},changeData:{name:"",loginName:"",tel:"",department:"",email:"",roles:[],roleId:[],id:""},list:[],loading:!1,listLoading:!1,viewDataData:{},page:0,total:0,searchData:{dataLoginName:"",dataName:"",dataRoleName:"",dataStatus:""},sourceTestData:[],sourceTableOptions:[],sourceTextOptions:[],sourceModifiedOptions:[],uploadStatus:!1}},created:function(){this.getList()},methods:{handleChange:function(t,a){this.fileList=a,this.modelCLose=!1,this.uploadStatus=!0},beforeRemove:function(t,a){return this.$confirm("Are you sure to delete ".concat(t.name,"?"))},removeFile:function(){this.fileList=[]},changeSourceData:function(){var t=this,a=[],e=[];this.sourceTestData.map((function(s){if(s.name===t.addData.tblName){var n=Object.values(s.columns);n.map((function(t){"VARCHAR"===t.typeName?a.push(t.name):"DATETIME"===t.typeName&&e.push(t.name)}))}})),this.sourceTextOptions=a,this.sourceModifiedOptions=e},changeDataBtn:function(t){var a=this;this.dataEidtStatus=!0,this.dataCreatNew=!0,this.addDataDialog=!0,this.modelCLose=!0,this.fileList.length>0&&this.$refs.upload.clearFiles(),lt(t.id).then((function(t){200===t.code&&(a.addData=t.data,a.fileList=t.data.filename?[{name:t.data.filename}]:[],a.addDataDialog=!1)}))},delData:function(t){var a=this;this.$confirm("Are you sure you want to delete data?",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then((function(){rt(t.id).then((function(t){200===t.code&&(a.$message({type:"success",message:"Delete Success!"}),a.getList())}))})).catch((function(){}))},dataSaerchBtn:function(){this.searchData.dataName=this.searchData.dataName?this.searchData.dataName.trim():null,this.dataPage=1,this.getList()},uploadSuccess:function(){this.saveLoading=!1,this.dataCreatNew=!1,this.getList(),this.modelCLose=!0,this.$message.success("Upload success!")},saveDataBtn:function(t){var a=this;this.$refs[t].validate((function(t){if(!t)return!1;if(a.saveLoading=!0,a.dataEidtStatus){var e={date:a.addData.date,disabled:a.addData.disabled,description:a.addData.description,status:a.addData.status,id:a.addData.id,name:a.addData.name,uid:a.addData.uid},s=a.fileList.length>0?Object.assign({},e,{filename:a.fileList[0].name}):e;ot(a.addData.id,s).then((function(t){200===t.code&&(a.uploadData.uid=t.data.uid,a.fileList.length>0&&a.uploadStatus?a.$refs.upload.submit():(a.saveLoading=!1,a.dataCreatNew=!1,a.getList(),a.modelCLose=!0,a.$message({type:"success",message:"Save success!"})))}))}else{if("ElESTICSEARCH"==a.addData.srcType)var n={description:a.addData.description,disabled:a.addData.disabled,id:0,name:a.addData.name};dt(n).then((function(t){200===t.code&&(a.uploadData.uid=t.data.uid,a.$refs.upload.submit())}))}}))},addDataBtn:function(){this.dataCreatNew=!0,this.dataEidtStatus=!1,this.uploadStatus=!1,this.modelCLose=!0,this.addData={description:"",srcType:"ElESTICSEARCH",name:"",url:"",entTbl:"",disabled:!1,driver:"",status:"",groupId:0,id:0,idCol:"",password:"",relTbl:"",sql:"",tblName:"",textCol:"",uid:"",userId:0,username:""},this.$refs.upload.clearFiles(),this.fileList=[]},handleCurrentChange:function(t){this.page=t-1,this.getList()},handleFilter:function(){this.getList()},getList:function(){var t=this;this.listLoading=!0;var a={page:this.page,size:10};it(a).then((function(a){200===a.code&&(t.list=a.data.content,t.listLoading=!1,t.total=a.data.totalElements)}))},cancelEdit:function(t){t.title=t.originalTitle,t.edit=!1,this.$message({message:"The title has been restored to the original value",type:"warning"})},confirmEdit:function(t){t.edit=!1,t.originalTitle=t.title,this.$message({message:"The title has been edited",type:"success"})},resetForm:function(t){this.$refs[t].resetFields(),this.changeData.roleId&&(this.changeData.roleId=[])}}},ut=ct,pt=Object(m["a"])(ut,st,nt,!1,null,"1b6e73fc",null),ht=pt.exports,mt={components:{activeTasks:f,registeredTasks:A,inputModule:W,workModule:et,pipelinesModule:ht},props:{},data:function(){return{activeName:"first"}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{}},Dt=mt,ft=Object(m["a"])(Dt,s,n,!1,null,"4ddbafe2",null);a["default"]=ft.exports},e32d:function(t,a,e){"use strict";var s=e("0167"),n=e.n(s);n.a}}]);